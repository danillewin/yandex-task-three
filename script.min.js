app={},app.vm={};try{window.AudioContext=window.AudioContext||window.webkitAudioContext,app.AudioContext=new AudioContext}catch(e){alert("Web Audio API is not supported in this browser")}!function(a){a.vm.TrackList=function(){var a=this;a.tracks=ko.observableArray([]),a.initDragDrop()},a.vm.TrackList.prototype.addTrack=function(b){var c,d,e,f,g=this,h="",i=new FileReader,j=a.AudioContext;ID3.loadTags(b,function(){if(c=ID3.getAllTags(b),c.picture){e=c.picture;for(var a=0;a<e.data.length;a++)h+=String.fromCharCode(e.data[a]);f="data:"+e.format+";base64,"+window.btoa(h)}else f="images/unknown.png";d={artist:c.artist||"unknown",title:c.title||"unknown",album:c.album||"unknown",year:c.year,lyrics:c.lyrics,picture:f},i.onload=function(){j.decodeAudioData(i.result,function(a){d.audio=a}),g.tracks.push(d)},i.readAsArrayBuffer(b)},{tags:["artist","title","album","year","lyrics","picture"],dataReader:FileAPIReader(b)})},a.vm.TrackList.prototype.initDragDrop=function(){var a=this;document.getElementsByClassName("track-list")[0].addEventListener("dragenter",function(a){this.classList.add("track-list_dragover")}),document.getElementsByClassName("track-list")[0].addEventListener("dragleave",function(a){this.classList.remove("track-list_dragover")}),document.getElementsByClassName("track-list")[0].addEventListener("drop",function(b){b.preventDefault&&b.preventDefault(),this.classList.remove("track-list_dragover");var c=b.dataTransfer.files[0];return a.addTrack(c),!1}),document.getElementsByClassName("track-list")[0].addEventListener("dragover",function(a){return a.preventDefault&&a.preventDefault(),a.dataTransfer.dropEffect="copy",!1})}}(window.app),app.TrackList=new app.vm.TrackList,ko.applyBindings(app.TrackList,document.getElementsByClassName("track-list")[0]),function(a){a.vm.Player=function(){var b=this;b.context=a.AudioContext,b.currentTime=ko.observable(0),b.source=b.context.createBufferSource(),b.playing=ko.observable(!1),b.vol=ko.observable(),b.repeat=ko.observable(),b.shuffle=ko.observable(),b.equalizer=ko.observable(),b.currentTrack=ko.observable(),b.currentTrack=ko.observable(),b.tracks=a.TrackList.tracks,b.presets={jazz:"",normal:"",rock:"",pop:""},b.tracks.subscribe(function(){1==b.tracks().length&&b.currentTrack(b.tracks()[0])})},a.vm.Player.prototype.playPause=function(){var a=this;a.playing()?a.pause():a.play()},a.vm.Player.prototype.pause=function(){var a=this;a.source.stop(),a.playing(!1)},a.vm.Player.prototype.play=function(){var a=this;a.currentTrack()?(a.source.buffer||(a.source.buffer=a.currentTrack().audio,a.source.connect(a.context.destination)),a.source.start(0),a.playing(!0)):alert("Upload the track first")},a.vm.Player.prototype.prev=function(){},a.vm.Player.prototype.next=function(){}}(window.app),app.Player=new app.vm.Player,ko.applyBindings(app.Player,document.getElementsByClassName("controls")[0]);
//# sourceMappingURL=script.map